@tailwind base;
@tailwind components;
@tailwind utilities;

/* ===== BASE STYLES ===== */
@layer base {
  html {
    scroll-behavior: smooth;
    font-feature-settings: 'rlig' 1, 'calt' 1;
  }
  
  body {
    font-feature-settings: 'rlig' 1, 'calt' 1;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
  }

  /* Prevent flash of unstyled content */
  .loading body {
    visibility: hidden;
  }
}

/* ===== UTILITY CLASSES ===== */
@layer components {
  .section { 
    @apply py-16 md:py-24; 
  }
  
  .container { 
    @apply max-w-6xl mx-auto px-4; 
  }
  
  .text-muted-foreground { 
    @apply text-gray-600 dark:text-gray-400; 
  }
  
  .btn-primary {
    @apply bg-sky-500 hover:bg-sky-600 active:bg-sky-700 text-white px-6 py-3 rounded-lg font-semibold transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed;
  }
  
  .btn-secondary {
    @apply border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 px-6 py-3 rounded-lg font-semibold transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed;
  }
  
  .btn-outline {
    @apply border border-sky-500 text-sky-500 hover:bg-sky-500 hover:text-white px-6 py-3 rounded-lg font-semibold transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed;
  }
  
  .card {
    @apply bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow duration-200;
  }
  
  .input {
    @apply w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-sky-500 focus:border-transparent transition-colors duration-200;
  }
}

/* ===== ACCESSIBILITY ===== */
/* Skip to content link */
.skip-to-content:not(:focus) {
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

.skip-to-content:focus {
  position: fixed;
  top: 8px;
  left: 8px;
  padding: 0.75rem 1rem;
  background: white;
  color: black;
  border: 2px solid #0ea5e9;
  border-radius: 0.5rem;
  z-index: 10000;
  font-weight: 600;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
  text-decoration: none;
}

/* Focus styles */
@layer utilities {
  .focus-visible:focus-visible {
    @apply outline-none ring-2 ring-sky-500 ring-offset-2 ring-offset-gray-100 dark:ring-offset-gray-900;
  }
}

/* ===== REDUCED MOTION ===== */
@media (prefers-reduced-motion: reduce) {
  html {
    scroll-behavior: auto;
  }
  
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ===== HIGH CONTRAST MODE ===== */
@media (prefers-contrast: high) {
  .card {
    @apply border-2;
  }
  
  .btn-primary,
  .btn-secondary,
  .btn-outline {
    @apply border-2;
  }
}

/* ===== PRINT STYLES ===== */
@media print {
  .skip-to-content,
  nav,
  footer,
  button {
    display: none !important;
  }
  
  body {
    background: white !important;
    color: black !important;
  }
  
  a {
    text-decoration: underline;
  }
  
  a[href^="http"]:after {
    content: " (" attr(href) ")";
    font-size: 0.8em;
    color: #666;
  }
}

/* ===== LOADING STATES ===== */
.loading-spinner {
  @apply inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-current;
}

.skeleton {
  @apply bg-gray-200 dark:bg-gray-700 animate-pulse;
}

/* ===== PROSE IMPROVEMENTS ===== */
.prose {
  @apply max-w-none;
}

.prose h2 {
  @apply text-2xl font-bold mt-8 mb-4 text-gray-900 dark:text-gray-100;
}

.prose h3 {
  @apply text-xl font-semibold mt-6 mb-3 text-gray-900 dark:text-gray-100;
}

.prose p {
  @apply mb-4 text-gray-700 dark:text-gray-300 leading-relaxed;
}

.prose ul {
  @apply list-disc list-inside mb-4 space-y-2 text-gray-700 dark:text-gray-300;
}

.prose a {
  @apply text-sky-600 dark:text-sky-400 hover:text-sky-800 dark:hover:text-sky-200 underline decoration-sky-300 decoration-2 underline-offset-2 hover:decoration-sky-500 transition-colors;
}

.prose strong {
  @apply font-semibold text-gray-900 dark:text-gray-100;
}

.prose code {
  @apply bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded text-sm font-mono;
}

.prose blockquote {
  @apply border-l-4 border-sky-500 pl-4 italic text-gray-600 dark:text-gray-400;
}

/* ===== CUSTOM SCROLLBAR ===== */
@layer utilities {
  .scrollbar-thin {
    scrollbar-width: thin;
    scrollbar-color: rgb(156 163 175) transparent;
  }
  
  .scrollbar-thin::-webkit-scrollbar {
    width: 6px;
  }
  
  .scrollbar-thin::-webkit-scrollbar-track {
    background: transparent;
  }
  
  .scrollbar-thin::-webkit-scrollbar-thumb {
    background: rgb(156 163 175);
    border-radius: 3px;
  }
  
  .scrollbar-thin::-webkit-scrollbar-thumb:hover {
    background: rgb(107 114 128);
  }
}

/* ===== ANIMATION IMPROVEMENTS ===== */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.animate-fade-in-up {
  animation: fadeInUp 0.6s ease-out;
}

.animate-fade-in {
  animation: fadeIn 0.4s ease-out;
}

.animate-slide-in-right {
  animation: slideInRight 0.4s ease-out;
}

/* ===== RTL SUPPORT ENHANCEMENTS ===== */
[dir="rtl"] {
  text-align: right;
}

[dir="rtl"] .container {
  @apply px-6;
}

[dir="rtl"] .prose {
  text-align: right;
}

[dir="rtl"] .prose ul {
  @apply list-outside mr-6 ml-0;
}

/* ===== DARK MODE IMPROVEMENTS ===== */
@media (prefers-color-scheme: dark) {
  html {
    color-scheme: dark;
  }
}

.dark-image {
  /* Fixed: Tailwind arbitrary value for 110% contrast */
  @apply dark:brightness-90 dark:contrast-[1.1];
}

/* ===== MOBILE OPTIMIZATIONS ===== */
@media (max-width: 768px) {
  .container {
    @apply px-4;
  }
  
  .prose {
    @apply text-base;
  }
  
  .prose h1 {
    @apply text-2xl;
  }
  
  .prose h2 {
    @apply text-xl;
  }
  
  .prose h3 {
    @apply text-lg;
  }
}

/* ===== TOUCH IMPROVEMENTS ===== */
@media (hover: none) and (pointer: coarse) {
  button,
  a {
    @apply min-h-[44px] min-w-[44px];
  }
}

/* ===== CUSTOM PROPERTIES FOR THEMING ===== */
:root {
  --color-primary: 14 165 233; /* sky-500 */
  --color-primary-dark: 2 132 199; /* sky-600 */
  --color-gray-50: 249 250 251;
  --color-gray-100: 243 244 246;
  --color-gray-900: 17 24 39;
  --color-gray-800: 31 41 55;
  
  /* Custom shadows */
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
}

/* ===== FORM IMPROVEMENTS ===== */
.form-group {
  @apply mb-4;
}

.form-label {
  @apply block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2;
}

.form-error {
  @apply text-red-600 dark:text-red-400 text-sm mt-1;
}

.form-success {
  @apply text-green-600 dark:text-green-400 text-sm mt-1;
}

/* ===== UTILITY EXTENSIONS ===== */
@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
  
  .bg-grid {
    background-image: 
      linear-gradient(to right, rgb(0 0 0 / 0.05) 1px, transparent 1px),
      linear-gradient(to bottom, rgb(0 0 0 / 0.05) 1px, transparent 1px);
    background-size: 20px 20px;
  }
  
  .dark .bg-grid {
    background-image: 
      linear-gradient(to right, rgb(255 255 255 / 0.05) 1px, transparent 1px),
      linear-gradient(to bottom, rgb(255 255 255 / 0.05) 1px, transparent 1px);
  }
}
